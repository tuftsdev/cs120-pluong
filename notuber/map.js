var script=document.createElement("script");script.src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBhXJr5eCkwhUUWGi7t1Hpi8Uo8PRHkH64&libraries=geometry,marker&callback=initMap",script.async=!0,window.initMap=function(){navigator.geolocation.getCurrentPosition((function(e){!function(e,t){var n=new google.maps.LatLng(e,t),o=new XMLHttpRequest;o.onreadystatechange=function(){if(4==o.readyState&&200==o.status){strcars=o.responseText,carsjson=JSON.parse(strcars);var a=new google.maps.InfoWindow({}),r=[],s=0,g=0,l="",c=0,p=0,d=0;for(i=0;i<carsjson.length;i++){idString=carsjson[i];var m=new google.maps.LatLng(idString.lat,idString.lng);s=google.maps.geometry.spherical.computeDistanceBetween(n,m),s*=621371e-9,0==g?g=s:s<g&&(g=s,l=idString.username,c=idString.lat,p=idString.lng),r[i]=[idString.username,idString.lat,idString.lng,s,"car.png"],d=i}var u="My Location is at latitude of: "+e+" and longitude of "+t+". The closest vehicle is "+l+" and is "+g+" miles from me.";r[d+1]=[u,e,t,0,""];var w={lat:e,lng:t},f=new google.maps.Map(document.getElementById("map"),{center:w,zoom:13});let h;for(i=0;i<r.length;i++)h=new google.maps.Marker({position:new google.maps.LatLng(r[i][1],r[i][2]),map:f,title:r[i][0],icon:r[i][4]}),google.maps.event.addListener(h,"click",function(e,t){return function(){a.setContent(r[t][0]+" is "+r[t][3]+" miles away from me."),a.open(f,e)}}(h,i));google.maps.event.addListener(h,"click",(function(){const n=[{lat:e,lng:t},{lat:c,lng:p}];new google.maps.Polyline({path:n,geodesic:!0,strokeColor:"#FF0000",strokeOpacity:1,strokeWeight:2}).setMap(f)}))}},o.open("POST","https://shielded-garden-30139.herokuapp.com/rides",!0),o.setRequestHeader("Content-type","application/x-www-form-urlencoded");var a="username=pPHjoZLM&lat="+e+"&lng="+t;o.send(a)}(e.coords.latitude,e.coords.longitude)}))},document.head.appendChild(script);